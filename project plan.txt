План проекта:
1. Создать план
2. Разобраться с методикой создания копий виртуалок. Записать тут пошаговые действия.
    
    Создаём клон виртуалки
    virt-clone --original ubuntu24.04 --name source_test --auto-clone

    Делаем очистку виртуалки
    sudo virt-sysprep -d source_test --hostname uu3 --operations defaults,-ssh-userdir

    после чего не получается подключиться, т.к. ssh на виртуалке не запущен из-за ошибки отсутсвия ssh-socket
    надо поэкспериментировать с исключением параметров кроме ssh-userdir
    Полный список параметров входящих в defaults (согласно версии deepseek):
        abrt-data, bash-history, blkid-tab, crash-data, cron-spool, 
        dhcp-client-state, dhcp-server-state, dovecot-data, logfiles, 
        machine-id, mail-spool, net-hostname, net-hwaddr, pam-data, 
        package-manager-cache, rpm-db, samba-db-log, script, smolt-uuid, 
        ssh-hostkeys, ssh-userdir, sssd-db-log, tmp-files, udev-persistent-net, 
        user-account, utmp, yum-uuid

2.1. ПОРЯДОК СОЗДАНИЯ ВИРТУАЛЬНОЙ МАШИНЫ

    1. Из виртуалки parent22 созданём виртуалку source
    2. Прокидываем в неё ключ из хоста
    3. Создаём новую виртуалку и кастомизируем сетевые настройки и hostname с помощью плейбуков

2.2. Перечень команд для работы/клонирования виртуалок 

    Клонирование виртуалки: virt-clone --original <NAME SOURCE> --name <NAME TARGET> --auto-clone
    
    Создание шаблона виртуалки (не изменять hostkey и не удалять директории ssh + принудительное включение службы ssh.service):
        sudo virt-sysprep -d source_test7 --hostname st7 --operations defaults,-ssh-hostkeys,-ssh-userdir --run-command "systemctl enable ssh"

    Просмотр ip виртуалки: virsh domifaddr <NAME>

    Просмотр всех виртуалок:    virsh list --all

    Полное удаление виртуалики: virsh undefine <NAME> --remove-all-storage

    Редактирование и перезагрузка dhcp kvm:
        sudo virsh net-edit default
        sudo virsh net-destroy default
        sudo virsh net-start default
        sudo virsh net-info default

    Список всех зарезервированных адресов в dhcp kvm: virsh net-dhcp-leases default

    Генерация ключа: ssh-keygen -t ed25519 -C "starshmail@yandex.ru"
    Копировние ключа на виртуалку: ssh-copy-id -i ~/.ssh/id_ed25519.pub starsh@192.168.122.121
    Удаление строки из файла ~/.ssh/known_hosts: ssh-keygen -R 192.168.122.22

    virsh setmem source --size 1G --config
    virsh setmaxmem source --size 2G --config
    virsh setvcpus pp-front 1 --config
    virsh setvcpus pp-front 2 --maximum --config

    virsh 

2.3. Адреса "родительских" виртуалок
    192.168.122.10 - Ubuntu 24.04.3 CPU 2 mem 2048 disk 25Gb
    192.168.122.11 - Ubuntu 22.04.5 CPU 2 mem 2048 disk 25Gb

2.4. Создать виртуалку иходник, из которой создать виртуалку source, которая будет использоваться для создания 5 виртуальных машин.
    Характеристики source:  статически ip 192.168.122.11
                            ключ для входа по ssh
                            имя хоста source

3. Сделать 5 плейбуков создающих виртуалки со следующими характеристиками:
    - 192.168.122.20 pp-front CPU 1 mem 1024 disk 25Gb (nginx)
    - 192.168.122.21 pp-back1 CPU 1 mem 1024 disk 25Gb (wordpress)
    - 192.168.122.22 pp-back2 CPU 1 mem 1024 disk 25Gb (wordpress)
    - 192.168.122.23 pp-BDmaster CPU 1 mem 1024 disk 25Gb (MySQL source)
    - 192.168.122.24 pp-BDslave CPU 1 mem 1024 disk 25Gb (MySQL replica)
    - 192.168.122.25 pp-MLA CPU 2 mem 6144 disk 25Gb (grafana, ELK, prometheus)


Установка MySQL
sudo apt install mysql-server-8.0


select * from user where user='repl'\G

Админка wordpress:
    92.168.122.20/wp-admin
    test 123

Ports:
    3000 - grafana
    5044 - logstash
    5140 - 
    5601 - kibana
    9090 - prometheus
    9093 - alertmanager
    9094 - 
    9100 - prometheus-node-exporter
    9200 - 

Надо доделать:
    + алертинг
    - https
    + фаервол
    - бакап и восстановление базы
    - нарисовать схему